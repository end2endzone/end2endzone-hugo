{{ define "main" }}
  <article>
    <div class="post">
      {{ .Render "header" }}

      {{/* end2endzone override: enable or disable share buttons on a per page setting */}}
      {{ if not ( eq .Params.share_buttons false) }}
        <div id="socnet-share">
          {{ partial "share-buttons" . }}
        </div>
      {{ end }}
	  
      <div class="content">
        {{ .Render "featured" }}
		
        {{/* end2endzone override: enable or disable table-of-contents on a per page setting */}}
        {{ if not ( eq .Params.toc false) }}
          {{ partial "toc" . }}
        {{ end }}
		
        {{ .Content }}
      </div>
      <footer>
        {{ .Render "stats" }}
      </footer>
    </div>
    {{ if not ( eq .Params.comments false) }}
      {{ .Render "comments" }}
    {{ end }}
  </article>
  <div class="pagination">
    {{ if .NextInSection }}
      <a href="{{ .NextInSection.RelPermalink }}" class="button left"><span>{{ .NextInSection.Title }}</span></a>
    {{ end }}
    {{ if .PrevInSection }}
      <a href="{{ .PrevInSection.RelPermalink }}" class="button right"><span>{{ .PrevInSection.Title }}</span></a>
    {{ end }}
  </div>

  {{/* end2endzone override: Add support for mermaid as per https://hugomods.com/docs/content/mermaid/ */}}
  {{/* Documentation of https://hugomods.com/docs/content/mermaid/ states to load 
      the following partial: `{{ partial "mermaid/assets/js" . }}`.
      But there is a bug in https://github.com/hugomods/mermaid/blob/main/layouts/partials/mermaid/assets/js.html
      which do not render .Site.Params.mermaid.js_url. It tries to escape the input string.
      The result is the following output:
      ```
      import mermaid from "https:\/\/cdn.jsdelivr.net\/npm\/mermaid@latest\/dist\/mermaid.esm.min.mjs";
      ```
  */}}

  {{/* end2endzone override: Add support for mermaid as per https://gohugo.io/content-management/diagrams/ */}}
  {{ if .Store.Get "hasMermaid" }}
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true, theme: 'dark' });
    </script>
  {{ end }}

{{ end }}
